# ノーズR補正 手動計算パターン

ユーザーの手書き図に基づく計算式と適用方法。

## 記号の定義

- `R`: ノーズR値
- `θ`: テーパー角度（Z軸からの角度）
- `Za`: 元のZ座標（補正前）
- `Xa`: 元のX座標（補正前）
- `fz`: Z方向の補正量
- `fx`: X方向の補正量

---

## fz（Z方向）パターン

### パターン1 ✓
- **形状**: 下りテーパー → 隅R
- **刃の向き**: 通常（正刃 -Z方向）
- **計算式**: `fz = R(1 + tan(θ/2))`
- **適用**: `Za - (Z - fz)` = `Za - Z + fz`

### パターン2 ✓
- **形状**: 下りテーパー（背刃）→ 隅R
- **刃の向き**: 背刃
- **計算式**: `fz = R(1 + tan(θ/2))`
- **適用**: `Za + (Z + fz)`

### パターン3 ✓
- **形状**: 隅R → 上りテーパー
- **刃の向き**: 刃と同方向
- **計算式**: `fz = R(1 - tan(θ/2))`
- **適用**: `Za - (Z - fz)` = `Za - Z + fz`

### パターン4 ✓
- **形状**: 上りテーパー → 角R
- **刃の向き**: 通常
- **計算式**: `fz = R(1 - tan(θ/2))`
- **適用**: `Za + (Z + fz)`

### パターン5 ✓
- **形状**: 上りテーパー → 角R
- **刃の向き**: 反対刃 / +Z方向に削る
- **計算式**: `fz = R(1 - tan(θ/2))`
- **適用**: `Za - (Z + fz)`

### パターン6 ✓
- **形状**: 隅R → 上りテーパー
- **刃の向き**: 反対刃 / +Z方向に削る
- **計算式**: `fz = R(1 - tan(θ/2))`
- **適用**: `Za + (Z - fz)`

### パターン7 ✓
- **形状**: 角R → 下りテーパー
- **刃の向き**: 反対刃 +Z方向
- **計算式**: `fz = R(1 + tan(θ/2))`
- **適用**: `Za + (Z - fz)`

### パターン8 ✓
- **形状**: 下りテーパー → 隅R
- **刃の向き**: 反対刃 +Z方向
- **計算式**: `fz = R(1 + tan(θ/2))`
- **適用**: `Za - (Z + fz)`

---

## fx（X方向）パターン

### パターン9 ✓
- **形状**: 上りテーパー → 隅R
- **刃の向き**: 正刃 -Z方向
- **計算式**: `fx = 2R(1 - tan((90°-θ)/2))`
- **適用**: `Xa + (X - fx)`

### パターン10 ✓ 検証済み
- **形状**: 下りテーパー → 隅R
- **刃の向き**: 正刃 -Z方向
- **計算式**: `fx = 2R(1 + tan((90°-θ)/2))`
- **適用**: `Xa - (X + fx)`
- **注**: 幾何学的な対称性および中心軌跡法による検証の結果、正しい式であることを確認。

---

## まとめ

### 計算式の使い分け

| 条件 | fz | fx |
|------|----|----|
| 下りテーパー（X減少） | `1 + tan(θ/2)` | `1 + tan((90°-θ)/2)` |
| 上りテーパー（X増加） | `1 - tan(θ/2)` | `1 - tan((90°-θ)/2)` |

### 適用方法の決定要因
- 刃の向き（正刃/背刃/反対刃）
- 切削方向（-Z方向 / +Z方向）
- 形状の接続（隅R/角R/テーパー）
